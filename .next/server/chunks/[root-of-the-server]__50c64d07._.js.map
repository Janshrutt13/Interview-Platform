{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 3, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"","debugId":null}},
    {"offset": {"line": 81, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/lenovo/OneDrive/Desktop/interview-platform/firebase/admin.ts"],"sourcesContent":["import {initializeApp , cert , getApps} from \"firebase-admin/app\";\r\nimport {getAuth} from \"firebase-admin/auth\";\r\nimport {getFirestore} from \"firebase-admin/firestore\";\r\n\r\nconst initFirebaseAdmin = () => {\r\n    const apps = getApps();\r\n\r\n    if(!apps.length){\r\n        initializeApp({\r\n            credential : cert({\r\n                projectId : process.env.FIREBASE_PROJECT_ID,\r\n                clientEmail : process.env.FIREBASE_CLIENT_EMAIL,\r\n                privateKey : process.env.FIREBASE_PRIVATE_KEY?.replace(/\\\\n/g, \"\\n\"),\r\n            }),\r\n        });\r\n    }\r\n\r\n\r\n    return {\r\n        auth : getAuth(),\r\n        db : getFirestore(),\r\n    }\r\n}\r\n\r\nexport const {db, auth} = initFirebaseAdmin()"],"names":[],"mappings":";;;;;;AAAA;AACA;AACA;;;;;;;;;;AAEA,MAAM,oBAAoB;IACtB,MAAM,OAAO,IAAA,2JAAO;IAEpB,IAAG,CAAC,KAAK,MAAM,EAAC;QACZ,IAAA,iKAAa,EAAC;YACV,YAAa,IAAA,wJAAI,EAAC;gBACd,WAAY,QAAQ,GAAG,CAAC,mBAAmB;gBAC3C,aAAc,QAAQ,GAAG,CAAC,qBAAqB;gBAC/C,YAAa,QAAQ,GAAG,CAAC,oBAAoB,EAAE,QAAQ,QAAQ;YACnE;QACJ;IACJ;IAGA,OAAO;QACH,MAAO,IAAA,6JAAO;QACd,IAAK,IAAA,4KAAY;IACrB;AACJ;AAEO,MAAM,EAAC,EAAE,EAAE,IAAI,EAAC,GAAG","debugId":null}},
    {"offset": {"line": 123, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/lenovo/OneDrive/Desktop/interview-platform/app/api/user/skills/route.ts"],"sourcesContent":["import { NextRequest, NextResponse } from \"next/server\";\r\nimport { auth, db } from \"@/firebase/admin\";\r\nimport { FieldValue } from \"firebase-admin/firestore\";\r\nimport { getAuth } from \"firebase/auth\";\r\nimport { app } from \"@/firebase/client\";\r\n\r\nasync function getUidFromRequest(req: NextRequest): Promise<string | null> {\r\n  const authHeader = req.headers.get(\"authorization\");\r\n  console.log(\"Auth header:\", authHeader ? \"Present\" : \"Missing\");\r\n  \r\n  if (!authHeader) return null;\r\n  \r\n  const token = authHeader.split(\" \")[1];\r\n  console.log(\"Token extracted:\", token ? \"Present\" : \"Missing\");\r\n  \r\n  if (!token) return null;\r\n  \r\n  try {\r\n    const decoded = await auth.verifyIdToken(token);\r\n    console.log(\"Token decoded successfully, UID:\", decoded.uid);\r\n    return decoded.uid;\r\n  } catch (error) {\r\n    console.error(\"Token verification failed:\", error);\r\n    return null;\r\n  }\r\n}\r\n\r\nexport async function POST(req: NextRequest) {\r\n  try {\r\n    const uid = await getUidFromRequest(req);\r\n    console.log(\"POST /api/user/skills - UID:\", uid);\r\n    \r\n    if (!uid) {\r\n      return NextResponse.json({ error: \"Unauthorized\" }, { status: 401 });\r\n    }\r\n    \r\n    const { skill, domain } = await req.json();\r\n    console.log(\"POST /api/user/skills - Data:\", { skill, domain });\r\n    \r\n    if (!skill || typeof skill !== \"string\" || !domain) {\r\n      return NextResponse.json({ error: \"Invalid skill or domain\" }, { status: 400 });\r\n    }\r\n    \r\n    const skillObj = { name: skill, domain };\r\n    console.log(\"POST /api/user/skills - Skill object:\", skillObj);\r\n    \r\n    const userRef = db.collection(\"users\").doc(uid);\r\n    const userDoc = await userRef.get();\r\n    \r\n    console.log(\"POST /api/user/skills - User exists:\", userDoc.exists);\r\n    \r\n    if (!userDoc.exists) {\r\n      await userRef.set({ skills: [skillObj] }, { merge: true });\r\n      console.log(\"POST /api/user/skills - Created new user with skills\");\r\n      return NextResponse.json({ success: true, created: true });\r\n    } else {\r\n      const data = userDoc.data();\r\n      console.log(\"POST /api/user/skills - Existing skills:\", data?.skills);\r\n      \r\n      if (!Array.isArray(data?.skills)) {\r\n        await userRef.update({ skills: [skillObj] });\r\n        console.log(\"POST /api/user/skills - Initialized skills array\");\r\n        return NextResponse.json({ success: true, initialized: true });\r\n      }\r\n      \r\n      await userRef.update({ skills: FieldValue.arrayUnion(skillObj) });\r\n      console.log(\"POST /api/user/skills - Added skill to existing array\");\r\n      return NextResponse.json({ success: true });\r\n    }\r\n  } catch (error) {\r\n    console.error(\"Error adding skill:\", error);\r\n    return NextResponse.json({ error: \"Failed to add skill\", details: String(error) }, { status: 500 });\r\n  }\r\n}\r\n\r\nexport async function DELETE(req: NextRequest) {\r\n  try {\r\n    const uid = await getUidFromRequest(req);\r\n    if (!uid) {\r\n      return NextResponse.json({ error: \"Unauthorized\" }, { status: 401 });\r\n    }\r\n    const { skill, domain } = await req.json();\r\n    if (!skill || typeof skill !== \"string\" || !domain) {\r\n      return NextResponse.json({ error: \"Invalid skill or domain\" }, { status: 400 });\r\n    }\r\n    \r\n    const skillObj = { name: skill, domain };\r\n    const userRef = db.collection(\"users\").doc(uid);\r\n    await userRef.update({ skills: FieldValue.arrayRemove(skillObj) });\r\n    return NextResponse.json({ success: true });\r\n  } catch (error) {\r\n    console.error(\"Error removing skill:\", error);\r\n    return NextResponse.json({ error: \"Failed to remove skill\", details: String(error) }, { status: 500 });\r\n  }\r\n}\r\n\r\nexport async function GET(req: NextRequest) {\r\n  try {\r\n    const uid = await getUidFromRequest(req);\r\n    console.log(\"GET /api/user/skills - UID:\", uid);\r\n    \r\n    if (!uid) {\r\n      return NextResponse.json({ error: \"Unauthorized\" }, { status: 401 });\r\n    }\r\n    \r\n    const userRef = db.collection(\"users\").doc(uid);\r\n    const userDoc = await userRef.get();\r\n    \r\n    console.log(\"GET /api/user/skills - User exists:\", userDoc.exists);\r\n    \r\n    if (!userDoc.exists) {\r\n      console.log(\"GET /api/user/skills - No user document, returning empty skills\");\r\n      return NextResponse.json({ skills: [] });\r\n    }\r\n    \r\n    const data = userDoc.data();\r\n    console.log(\"GET /api/user/skills - User data:\", data);\r\n    console.log(\"GET /api/user/skills - Skills:\", data?.skills);\r\n    \r\n    return NextResponse.json({ skills: data?.skills || [] });\r\n  } catch (error) {\r\n    console.error(\"Error fetching skills:\", error);\r\n    return NextResponse.json({ error: \"Failed to fetch skills\" }, { status: 500 });\r\n  }\r\n}\r\n"],"names":[],"mappings":"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","debugId":null}}]
}